# 🏥 住院藥局儲位查詢 (IPD Storage Code Finder)

住院藥局藥品儲位查詢工具

> 專為住院藥局設計，可依「UD儲位區」、「首日儲位區」、「庫存區」切換查詢模式，即時顯示藥品對應的儲位代碼。

---

## 🚀 功能特色

- 🔄 **自動讀取 GitHub main 分支**的最新 Excel (`Storage Code.xlsx`)
- 🔍 **支援模糊搜尋與部分關鍵字**（例如輸入「阿奇」即可找到「阿奇黴素」）
- 🔘 **三種查詢模式切換**：
  - **UD 儲位區** (UD Storage)
  - **首日儲位區** (First Dose Storage)
  - **庫存區** (Inventory Area)
- 📋 **精簡顯示**：僅顯示 **藥品名稱** 與 **儲位代碼**，介面更清爽。
- 🧩 **勾選暫存清單功能**：可將不同區的藥品勾選加入下方清單，並標示其來源類型（如：UD、庫存）。
- ➕ **補充數量欄位**：可對**已勾選**藥品輸入「補充數量」。
- 🧾 **CSV 匯出**：匯出欄位包含 `藥品名稱、類型、儲位代碼、補充數量`。
- 💡 **純前端執行**：無須後端伺服器，資料不外傳，安全快速。
- 📱 **RWD 響應式**：支援手機、平板與桌機瀏覽。

---

## 💡 使用方式

1. 開啟網頁
   👉 [**IPD Storage Code Finder**](https://almightyhao.github.io/Storage-Code-Finding/Storage%20Code%20Finding.html)
2. **選擇查詢區域**：點選上方的「UD儲位區」、「首日儲位區」或「庫存區」。
3. 在輸入框輸入藥名（完整或部分關鍵字）。
4. 點選 **「重新整理」** 可強制重新抓取最新的 Excel 檔案。
5. 在搜尋結果左側 **勾選** 藥品以加入暫存清單。
   - 於下方清單的「**補充數量**」欄直接輸入欲補數量（可空白或 ≥ 0 整數）。
   - **❌ 移除按鈕**可刪除單筆；**全部清空**會清除所有勾選與數量。
   - **匯出 CSV**：將目前的暫存清單匯出成 Excel 可讀的 CSV 檔。

---

## 📂 Excel 格式說明

此工具讀取儲存庫根目錄下的 `Storage Code.xlsx`。為了讓程式正確讀取，Excel **第一列標題** 需包含以下關鍵字（程式會自動對應）：

- **藥品名稱**：`藥名`, `品名`, `Drug`, `Name`, `名稱`, `藥品名稱` (任一即可)
- **UD 儲位代碼**：`UD儲位區`, `UD儲位區代碼`
- **首日 儲位代碼**：`首日儲位區`, `首日儲位區代碼`
- **庫存區 代碼**：`庫存區`, `庫存區代碼`

> **注意**：若 Excel 中某藥品在該欄位空白，程式將顯示空白代碼。

---

## 🧭 技術架構

| 模組 | 功能 | 來源 |
|------|------|------|
| [SheetJS (xlsx)](https://github.com/SheetJS/sheetjs) | 解析 Excel 檔案 | CDN (unpkg) |
| [Fuse.js](https://fusejs.io/) | 前端模糊搜尋引擎 | CDN (jsdelivr) |
| HTML5 + CSS3 + ES6 | 介面與邏輯 | Native (無框架) |

---

## 🧩 版本紀錄

| 版本 | 日期 | 說明 |
|------|------|------|
| **v1.1** | 2025/12/12 | **欄位架構調整**：移除一般調劑，改為「庫存區」查詢；移除顯示「儲位區」欄位，僅保留「儲位代碼」以簡化版面。 |
| **v1.0** | 2025/11/13 | **建立住院藥局版本**：新增單位切換功能。 |

---

📦 **Repository:** [github.com/Almightyhao/Storage-Code-Finding](https://github.com/Almightyhao/Storage-Code-Finding)
