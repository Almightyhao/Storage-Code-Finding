# 🧾 Storage Code Finder

門診藥品儲位查詢工具（**0912 TSGH 儲位更新版**）  

> 由 Excel 自動載入的輕量查詢系統，可即時搜尋藥品儲位、庫存區位置。  

---

## 🚀 功能特色

- 🔄 **自動讀取 GitHub main 分支**的最新 Excel (`Storage Code.xlsx`)
- 🔍 **支援模糊搜尋與部分關鍵字**（例如輸入「阿奇」即可找到「阿奇黴素」）
- 📋 顯示對應欄位：**藥品名稱、儲位區、庫存區**
- 🧩 **勾選暫存清單功能**：可將查詢結果勾選加入下方清單，暫存後再查看或匯出 CSV
- 💾 **LocalStorage 保存勾選狀態**，重新整理頁面不會消失
- 💡 完全前端執行，無須伺服器、無資料外傳
- ➕ **補充數量欄位（新）**：只對**已勾選**藥品顯示「補充數量」可直接輸入整數（可留空）
- 👁️ **即時顯示（新）**：輸入時右側會顯示數字膠囊，便於盤點校閱
- 🧾 **CSV 匯出含數量（新）**：匯出時新增「補充數量」欄位
- 📱 **手機直式優化（新）**：補充數量欄會自動放大；輸入框與數字膠囊改為上下堆疊，避免看不到完整數字
- 🔁 **狀態同步（新）**：取消勾選或全部清空時，同步清除對應的補充數量；重新載入仍可自動還原（若 Excel 版本已移除該藥，舊記錄會被清理）

---

## 💡 使用方式

1. 開啟網頁  
   👉 [**Storage Code Finder**](https://almightyhao.github.io/Storage-Code-Finding/)
2. 在輸入框輸入藥名（完整或部分關鍵字）
3. 點選 **「重新整理」** 可重新抓取最新 Excel
4. 在搜尋結果左側**勾選**藥品以加入暫存清單  
   - 於下方清單的「**補充數量**」欄直接輸入欲補數量（可空白或 ≥ 0 整數）  
   - **移除**可刪除單筆；**全部清空**會清除勾選與所有數量  
   - **匯出 CSV**：包含 `藥品名稱、儲位區、庫存區、補充數量`

---

## 📂 Excel 更新說明

- Excel 檔案名稱：`Storage Code.xlsx`  
- 檔案位置：**repo 根目錄**
- 更新方式：上傳新版本至 `main` 分支 → 網頁自動抓取最新版本  

---

## 🧭 技術架構

| 模組 | 功能 | 來源 |
|------|------|------|
| [SheetJS (xlsx)](https://github.com/SheetJS/sheetjs) | 解析 Excel | CDN |
| [Fuse.js](https://fusejs.io/) | 模糊搜尋引擎 | CDN |
| HTML + CSS + JS | 前端顯示介面 | 自製輕量版 |

---

## 🧩 版本紀錄

| 版本 | 日期 | 說明 |
|------|------|------|
| **1021** | 2025/10/21 | **新增** 已選清單「補充數量」可直接輸入、即時膠囊顯示；CSV 匯出含補充數量；手機直式版面優化；取消勾選/全部清空同步清除數量；LocalStorage 還原與殘留清理。 |
| **1017** | 2025/10/17 | 新增「勾選暫存清單」功能，可在下方清單中查看或匯出勾選藥品 |
| **0912** | 2025/09/12 | TSGH 儲位更新版，支援自動載入 main 分支 Excel 與模糊搜尋 |

---

📦 **Repository:** [github.com/Almightyhao/Storage-Code-Finding](https://github.com/Almightyhao/Storage-Code-Finding)
