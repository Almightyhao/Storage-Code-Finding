# 🏥 住院藥局儲位查詢 (IPD Storage Code Finder)

住院藥局藥品儲位查詢工具（**1212版本**）

> 專為住院藥局設計，可依「UD調劑」、「首日調劑」、「庫存區」切換單位，即時查詢藥品儲位區與儲位代碼。

---

## 🚀 功能特色

- 🔄 **自動讀取 GitHub main 分支**的最新 Excel (`Storage Code.xlsx`)
- 🔍 **支援模糊搜尋與部分關鍵字**（例如輸入「阿奇」即可找到「阿奇黴素」）
- 🔘 **單位切換**：可自由切換「一般調劑」、「UD調劑」、「首日調劑」，搜尋結果自動更新。
- 📋 **顯示對應欄位**：**藥品名稱、儲位區、儲位代碼**（依所選單位顯示）。
- 🧩 **勾選暫存清單功能**：可將不同單位的藥品勾選加入下方清單，並顯示其所屬「單位」。
- ➕ **補充數量欄位**：可對**已勾選**藥品輸入「補充數量」。
- 🧾 **CSV 匯出含單位與數量**：匯出時包含 `藥品名稱、單位、儲位區、儲位代碼、補充數量`。
- 💡 完全前端執行，無須伺服器、無資料外傳。
- 📱 **RWD 響應式**：支援手機與平板瀏覽。

---

## 💡 使用方式

1. 開啟網頁
   👉 [**IPD Storage Code Finder**](https://almightyhao.github.io/Storage-Code-Finding/Storage%20Code%20Finding.html)
2. 選擇調劑單位：「一般調劑」、「UD調劑」或「首日調劑」。
3. 在輸入框輸入藥名（完整或部分關鍵字）。
4. 點選 **「重新整理」** 可重新抓取最新 Excel。
5. 在搜尋結果左側**勾選**藥品以加入暫存清單。
   - 於下方清單的「**補充數量**」欄直接輸入欲補數量（可空白或 ≥ 0 整數）。
   - **❌ 移除按鈕**可刪除單筆；**全部清空**會清除勾選與所有數量。
   - **匯出 CSV**：包含 `藥品名稱、單位、儲位區、儲位代碼、補充數量`。

---

## 📂 Excel 更新說明

- Excel 檔案名稱：`Storage Code.xlsx`
- 檔案位置：**repo 根目錄**
- 更新方式：上傳新版本至 `main` 分支 → 網頁自動抓取最新版本。
- **Excel 欄位需求**（程式會自動抓取符合的欄位名稱）：
  - **藥名** (或 `品名`, `名稱`, `Drug`, `Name`)
  - **UD儲位區代碼**
  - **首日儲位區代碼**
  - **庫存區**

---

## 🧭 技術架構

| 模듈 | 功能 | 來源 |
|------|------|------|
| [SheetJS (xlsx)](https://github.com/SheetJS/sheetjs) | 解析 Excel | CDN |
| [Fuse.js](https://fusejs.io/) | 模糊搜尋引擎 | CDN |
| HTML + CSS + JS | 前端顯示介面 | 自製輕量版 |

---

## 🧩 版本紀錄

| 版本 | 日期 | 說明 |
|------|------|------|
| **v1.0** | 2025/11/13 | **建立住院藥局版本**；新增「UD/首日/庫存區」單位切換功能；調整搜尋邏輯與已選清單以符合住院藥局需求。 |

---

📦 **Repository:** [github.com/Almightyhao/Storage-Code-Finding](https://github.com/Almightyhao/Storage-Code-Finding)
